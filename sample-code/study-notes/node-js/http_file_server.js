"use strict";var fs=require("fs"),url=require("url"),path=require("path"),http=require("http"),root=path.resolve(process.argv[2]||"./file_server");console.log("Static root dir: "+root);var server=http.createServer(function(e,r){var t=url.parse(e.url).pathname,o=path.join(root,t),s=["/sample.txt","/sample-write.txt"],a=!1;fs.stat(o,function(t,i){if(t)console.log("404"+e.url),r.writeHead(404),r.end("404 Not Found");else if(i.isFile())console.log("200",e.url),r.writeHead(200),fs.createReadStream(o).pipe(r);else if(i.isDirectory())for(let e=0;e<s.length;e++){o=path.join(root,s[e]);try{fs.statSync(o),fs.createReadStream(o).pipe(r),a=!0}catch(e){a=!1}if(a)break}a||(console.log("404"+e.url),r.writeHead(404),r.end("404 Not Found"))})});server.listen(8080),console.log("Server is running on http://127.0.0.1:8080");